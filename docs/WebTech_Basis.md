**# Web 技術の基本
## Ch.1：Web技術とは
### Web とは
- 正式名称 World Wid Web, 文書を公開・閲覧するためのシステム.
- **ハイパーテキスト**という言語で構成され, **ハイパーリンク**によって世界中のあらゆる Web ページと繋がりを持つ.

### Web の用途
- 文書の閲覧.
  - 1つのドメインの Web ページの集まりを **Webサイト** という.
- 機能とユーザーのやり取りの橋渡しをする**ユーザーインターフェース**を提供.
  - e.g. ユーザーの操作を Webサーバーが代わりにメールサーバーに伝える.
- ソフトウェア同士のやり取りの橋渡しをする **API** を提供.
  - e.g. アプリとWebサーバー間のデータ送受信など.

### HTML とブラウザ
- **HTML** はハイパーテキストを記述するための言語.
  - 表示方法やリンクを**タグ**によって表現するマークアップ言語の一種.
- **Webブラウザ** は HTML を解釈して, わかりやすく作り変えるためのプログラム.

### Webサーバーと HTTP
- **Webサーバー**は, Webブラウザからコンテンツの要求があった場合に, 必要なコンテンツ（ハイパーテキスト）を返すためのプログラム.
  - 「持っていない」という情報や, 別の Webサーバーへの案内といった情報を返すことも可能.
- コンテンツのやり取りに関する手順や送受信するメッセージの書式は **HTTP** という仕様で定義されている.
  - 世界標準であるため, どの企業のどんなブラウザ・Webサーバーでも同じ手順で Webサーバーとのやり取りが可能になっている.

### Webページ
- Webページを取得するには **URL** を指定することがスタートとなる.
  - URL には「どのやり取りの手順で」「どの Webサーバーに」「何のコンテンツを」取得するか, が情報として含まれている.
    - どのやり取りの手順で：http または https
    - どの Webサーバーに：ドメイン
    - 何のコンテンツを：HTML や画像など
  - URL をもとにコンテンツの取得を繰り返していくことで, ユーザーは要求した Webページを閲覧できるようになる.
- Web ページには, **静的ページ**と**動的ページ**の2種類がある.
  - 静的ページ：アクセスのたびに同じコンテンツが表示される Webページ.
  - 動的ページ：アクセスしたときの状況に応じて異なるコンテンツが表示される Webページ.
    - Webブラウザの要求に応じてプログラムが作動しており, それを作動させる仕組みを **GCI** という.
    - したがって, 動的ページでは URL は GCI が用意された場所を示す.
      - GCI から呼び出され, 作動するプログラムは**サーバーサイド・スクリプト**といい, Perl や Python, PHP, JavaScript などの**スクリプト言語**で記述される.
      - 一方で, HTML に埋め込まれ, ブラウザ上で作動するプログラムは**クライアントサイド・スクリプト**といい, 主に JavaScript が該当する.

### Web の標準化と設計思想
- HTML や CSS, XML などは **W3C**（HTML のみ **WHATWG**）によって**標準化**されている, すなわち一定の規格が定められている.
  - これは言語の機能拡張が個々に広がると, 「どの Webブラウザでも, ほぼ同じように Webページが表示される」という状態が実現しづらくなるからである.
- 標準化されたもの以外にも, Web にはある一定の設計思想がある.
  - **RESTful** なシステム
    - 統一インターフェース：予め定義された方法で, 情報をやり取りする（HTTP など）.
    - アドレス可能性：すべての情報が一意な URL で表される.
    - 接続性：やり取りされる情報の中にはリンクを含めることができる.
    - ステートレス性：やり取りは1回ごとに完結し, 以前のやり取りの結果に依存しない.
  - **セマンティック Web**
    - XML　により, テキストが属性などの**メタデータ**を持つことで, 検索可能精度を大幅に高める Web の構造.
    - ただし, メタデータの付与の膨大さがボトルネックとなり, なかなか普及しない.

## Ch.2：Web とネットワーク技術
### コンピーターネットワーク
- コンピューターが互いに接続して情報のやり取りをするネットワークの中で, コンピューターは以下の2つに大別される.
  - **サーバー**：ネットワーク上で情報・サービスを提供する.
  - **クライアント**：サーバーから提供された情報・サービスを利用する.
- 自宅や会社などの小規模なコンピューターネットワークを互いに繋ぐのがインターネットである.
  - インターネットはプロバイダ（ISP）によって提供される.
  - ISP 同士が階層構造を持って繋がる（IX）ことで, 世界中のサーバー・クライアントと通信が可能になっている.

### 標準プロトコル
- **プロトコル**：ネットワークに接続された機器同士が通信するときの共通のルール・手順.
- **TCP/IP** はあらゆる機器があらゆる機器と通信できるという意味で, 標準のプロトコル群として利用されている.
  - **アプリケーション層**：クライアントとサーバーのやり取り規定し, ネットワークに適した形へデータを変換する役割を担う. e.g. HTTP, FTP など.
  - トランスポート層：データ分割やデータ品質の保証を規定する. e.g. TCP, UDP.
  - インターネット層：ネットワーク化の通信を規定する. e.g. IP, ICMP など.
  - ネットワークインターフェース層：ハードウェアに関する規定. e.g. Wi-Fi など.
- たとえば, ブラウザからサーバーにデータを要求した際には, 下層に行くにつれて規定に則ったヘッダーが追加され（カプセル化）, 上層に行くにつれてそのヘッダーが除去されていく（非カプセル化）ことで応答を行っている. 

### IPアドレス
- **IPアドレス**：インターネットに接続されたコンピューターを特定し, データの行き先を管理する.
  - ところが, IPアドレスだけでは Webサービスなのかメールサービスなのかというコンピューターの提供するサービスまでは分からない
  - これを補完するのが, **ポート番号**であり, これによって特定のコンピューターの特定のサービスを受けることが可能になっている.

### URL とドメイン
- URL に関しては, Chapter.1 に記載した通り.
- ただし, 認識性の問題から IPアドレスの代わりに**ドメイン**を使用している.
  - 一般にIPアドレスによって通信先を特定するため, ドメインは IPアドレスに変換可能である.
  - これを可能とするのが **DNS** という仕組みであり, これを提供するのが **DNSサーバー**と呼ばれる階層型のコンピューター群である.

## HTTP の仕組み
### HTTPメッセージ
- HTTP はクライアントである Webブラウザと, サーバーである Webサーバー間のやり取りをするが, そのやり取りで利用されるのが **HTTPメッセージ**である.
  - HTTPメッセージは, Webブラウザからの要求としての **HTTPリクエスト**と, Webサーバーからの応答である **HTTPレスポンス**に大別される.

### HTTPリクエストと HTTPレスポンス
#### HTTPリクエスト
- HTTP リクエストの構成
  - リクエスト行：Webサーバーに対する「（サーバーが持つ）どのデータに」「どのような処理がしたいか」の要求内容.
  - メッセージヘッダー：Webブラウザやバージョン, 対応可能なデータタイプなどの付加的な情報.
  - メッセージボディ：Webブラウザのフォームなど, 入力された内容.
- 要求の具体的な内容は **HTTPメソッド**によって, リクエスト行に記述される. Web サイトで主に利用されるのは以下の2つ.
    - **GET**メソッド：コンテンツの取得を取得する. データ送信には機密性の低い URLパラメータを利用する.
    - **POST**メソッド：データを Webサーバーに送信する. GET とは異なり, メッセージボディにデータが組み込まれるため, データ送信の機密性が高い.

#### HTTPレスポンス
- HTTPレスポンスの構成
  - ステータス行：HTTPリクエストに対する, Webサーバー内の処理結果.
  - メッセージヘッダー：Webサーバーの種類や, 送信するデータ形式などの付加情報.
  - メッセージボディ：クライアントから要求された HTML ファイルや画像などのデータ.
- 要求に対する処理結果は **ステータスコード**によって, ステータス行に記述される. ステータスコードは5つに分類される.
    - 100番台：HTTPリクエストが処理中であることの通知.
    - 200番台：HTTPリクエストに対して, 正常に処理が完了したことを通知.
    - 300番台：HTTPリクエストに対して, 転送やリダイレクトなど Webブラウザ側で追加処理が必要なことを通知する.
    - 400番台：リクエストが不正であったり, リクエスト対象が存在しないことを示すクライアント側のエラー通知.
    - 500番台：高負荷などのサーバー側のエラー通知.

#### メッセージヘッダー
- HTTPリクエスト・HTTPレスポンスの双方に含まれる HTTPメッセージに関する詳細な情報.
  - 一般ヘッダーフィールド：HTTPメッセージの作成日時など.
  - リクエストヘッダーフィールド：リクエスト先のサーバー名やリファラー, Webブラウザの固有情報など.
  - レスポンスヘッダーフィールド：リダイレクト先の Webページの情報や, Webサーバーの固有情報など.
  - エンティティヘッダーフィールド：メッセージボディ内のデータタイプやサイズ, 有効期限などコンテンツに関わる固有情報など.

### TCP によるデータ通信
- HTTPリクエストと HTTPレスポンスにおけるデータの役割を担うのが TCP である.
- クライアントとサーバ間で通信可能なのかを確認する**コネクション**という通信経路を確立した上で, 実際のデータのやり取りを行う. コネクションを確立するための手順は以下.
  - クライアントからサーバーに対して, **SYNパケット**を送信する.  
  - サーバーが SYKパケットに応答して, 次はサーバーから SYKパケット + **ACKパケット**を送信する.
  - クライアントが送信されてきた SYKパケットに対して ACKパケットを送信する.

### HTTPのやりとり
#### HTTP/1.1
- HTTP/1.0 以前では1回のリクエストごとにコネクションを接続し, レスポンスがあると切断していた.
  - それでは複数のリクエストに対して効率が悪いため, コネクションを継続する **HTTPキープアライブ**という方式が, HTTP/1.0 から採用されている.
- また, 複数のリクエストを効率的に処理するために, 他処理のレスポンスを待たずに他のリクエストを送信する **HTTPパイプライン**が確立された.

#### HTTP/2
- さらなる効率化を目指し, Google が提案した SPDY というプロトコルをベースにいくつかの改良がなされた.
  - **HTTPストリーム**：HTTPパイプラインの「レスポンスの順番はリクエストの順番に従う」という弱点を改善したもの. 各リクエストにストリームが割り当てられ, レスポンスは早く処理が終わった順に返される.
  - テキスト形式からバイナリ形式へ：テキストデータの変換処理にかかる時間の短縮を可能とする.
  - メッセージヘッダーの圧縮：異なるリクエスト間で, 同じ情報を HPACK と呼ばれる方式で圧縮することで, 送受信するデータ量を差分だけに削減することを可能とする.
  - サーバープッシュ：コンテンツを表示するのに必要な他コンテンツをリクエストすることなく, サーバー側から提案し, 自動で送信すること.

### HTTPS
- HTTP の通信において, **SSL** や **TLS** と呼ばれる暗号化方式を組み合わせることでセキュリティを高めたのが **HTTPS** である.
  - 暗号化通信：第三者からの盗聴を防ぐ.
  - 改竄防止：データの送受信時にそのハッシュ値（**メッセージダイジェスト**）を取得することで, 改竄を検知することが可能.
  - なりすまし防止：Webサーバーに設置された **SSLサーバー証明書**を検証することで, 信頼された**認証局**によって認証された運営元かを特定できる.
- TCP のコネクションが確立された後, 以下のような手順（**SSL/TLS ハンドシェイク**）を踏むことで HTTPS通信が開始される.
  - 暗号化方式の決定：クライアントとサーバー間で利用可能な暗号化方式・メッセージダイジェストのスキーマなどが定められる.
  - 通信相手の証明：正しい Webサーバーであるのかを, SSLサーバー証明書によって確認する.
  - 鍵の交換：送信の暗号化および暗号化されたデータを復号するための鍵をクライアントとサーバー間で交換する.
  - 暗号化方式の確認：クライアントとサーバーの間で利用する暗号化方式の最終確認作業を行う.

### ステートレスとステートフル
- **ステートレス**：リクエストとレスポンスの1往復が独立して, 他のやり取りに依存しない設計のこと
- **ステートフル**：前回以前のリクエストとレスポンスの結果が, 次回以降のリクエストとレスポンスの処理に影響する設計のこと.
- HTTP は負荷を避けるため, ステートレスな設計になっているが, 近年の Webサービスの複雑化により, クライアントごとに以前の状態を保持する必要性も出てきた. e.g. ショッピングサイトの買い物カゴなど.
  - これを補完するのが **Cookie** である.
    - Web サーバーがコンテンツと一緒に, 接続してきた Webブラウザを識別するための情報（Cookie）を送信し, それを Webブラウザに保存することで, 接続相手を識別することが可能になる.
    - レスポンスのメッセージヘッダーに**Set-Cookieヘッダー**を, リクエストのメッセージヘッダーに**Cookieヘッダー**を記述することで, Cookie 情報を送受信している.
    - Cookie の種類.
      - セッション Cookie：有効期限が設定されておらず, ブラウザが閉じると同時に削除される Cookie.
      - non セッション Cookie：有効期限が来るまで, ブラウザを閉じようが残り続ける Cookie.

### セッション
- クライアントとサーバーの間における一連のやり取りのこと.
- あるブラウザからの処理を関連性のある一連の処理として扱う場合は Cookie を用いてセッションを管理できる.
  - Web ブラウザを識別する情報を **セッションID** といい, サーバーで生成され, 一般には Cookie に含めてブラウザに送信される.
  - これによって, 各クライアントがセッションID を渡すだけで, 自分の過去の処理に応じた情報にアクセスできるようになる.

### URI とは
- **URI**：情報やデータといったリソースを識別するための記述方法.
  - **URL**：リソースの場所を表す.
  - **UTN**：リソースの名前を表す.
- HTTP リクエストで, 各メソッドで操作したいリソースを特定するのにも URI が利用され, それらは特にリクエストメソッドに続いて記述されることから, **リクエストURI** と呼ばれる.
  - **絶対URI形式**と**相対URI形式**があり, 通常は後者が利用される.
- URI では特定の予約文字しか使えないため, 非予約文字はパーセントエンコーディングによって予約文字化される.

## Web のさまざまなデータ形式
### HTML
- タグに囲まれた文章によって構成される言語.
- **開始タグ**, 文章, **終了タグ**で成る塊を**要素**といい, それが何を示すかは**要素名**という.
- タグには**属性（Attribute）**が追加でき, リンクや引数を指定できる.

### 画像形式
- **JPEG**
  - 拡張子は .jpg や .jpeg.
  - 1677万色を扱い, 写真データなどに有用だが, データ圧縮による画質の劣化が激しい.
- **GIF**
  - 拡張子は .gif.
  - 256色しか扱えないが, アニメーションが可能であったり, 圧縮による劣化が起こらないなどの特徴がある.
- **PNG**
  - 拡張子は .png.
  - 1677万色扱え, 圧縮による劣化も起きず, GIFよりもデータサイズが小さい.
  - また, 透明度を扱うことができることも特徴.

### XML
- HTML と同じ親である **SGML** から派生したマークアップ言語.
- タグを自由に定義することができ, クライアントとサーバー間でデータのやり取りをする際にデータを構造化することを目的に利用されている.

### XHTML
- HTML を XML 文法で再定義したもの.
- XML を埋め込める特徴があり, **MathML** や **SVG** を活用できることが特徴.

### CSS
- HTML や XML の表示方法（体裁）を表現する言語.
- デバイスなどクライアントの種類によって, CSS を別に用意することができる.

### スクリプト言語
- 動的処理に使用される言語.
  - サーバーサイド・スクリプトは CGI から呼び出すため, HTML と分離している.
  - クライアントサイド・スクリプトは HTML に埋め込むことも可能だが, 一般に分離されている.
- **ECMAScript**
  - **JavaScript** を指し, 2社が開発していた類似言語を一定の規格で統一したもの.
  - Webブラウザに対する汎用性が高いことから, クライアントサイド・スクリプトとして活躍してきたが, 近年ではサーバーサイド・スクリプトとしての活躍の場も増えている.
- **Perl**
  - 文法の自由度が高いサーバーサイド・スクリプト.
- **Python**
  - スクリプトの可読性が高いサーバーサイド・スクリプト.
- **PHP**
  - CGI を介さずに, HTMLに埋め込んで使用できるサーバーサイド・スクリプト.
- **Ruby**
  - オブジェクト指向プログラミングに向いたサーバーサイド・スクリプト.

### DOM とは
- HTML や XML を扱うための手法（API）.
- クライアントサイド・スクリプトやブラウザの機能などのプログラムから HTML にアクセスするときに, DOM を介することでタグの情報から HTML を辿って文章を取得することができる.
- HTML のタグの階層構造をそのまま **DOMツリー**という形で扱い, ノードを辿ることであらゆる文書への参照を可能としている.

### JSON とは
- 構造化したデータを表すためのデータ記述言語の一種.
- 同じデータを木構造で表現できる XML と比べて...
  - JSON は数値や空データも扱うことができる.
  - JSON はデータを括弧で囲むだけなので（入れ子で階層）, データ量が小さい.
  - JSON は文書ではなく, JavaScript の書式に従っているため, DOM を経由する必要がない.
  - したがって, JSON は Webの世界で扱われることが多い.

### フィード
- Web サイトの更新履歴を配信するためのファイルで, ユーザーはフィードを取り込むことで Webサイトを訪れることなく最新の更新情報を閲覧できる.
  - **RSS**, **Atom**：代表的なフィード.
- Web 上のフィードを取得し, 管理するためのソフトウェアとして, **フィードリーダー**がある.
  - 複数の登録されたふぃーどを定期的にチェックして, 更新情報をユーザーがチェックできるように表示する機能を搭載している.
- Webサーバー上に音楽や動画ファイルを配置し, RSS を通して公開する**ポッドキャスト**という手法もある.
  - RSS は新しい放送を通知するために利用されている.

### マイクロフォーマット
- セマンティックWeb を実現するために, HTML の class要素などに各要素の意味（メタデータ）を埋め込む書式.
- e.g. この文字列は電話番号を表している, など.

### 音声・動画配信
- 音声や動画などは画像と同様, 通信速度高速化のために**エンコード**（圧縮）と**デコード**（伸張）といった処理が**コーデック**というソフトウェアで行われている.
  - エンコードによってアップロードされ, デコードによって再生される.
- 配信形式
  - **ダウンロード配信**：Webサーバーからダウンロードしてもらって, 終了後はいつでも再生できる形式.
  - **プログレッシブダウンロード配信**：ダウンロード中でもダウンロードした分までは再生できる形式.
  - **ストリーミング配信**：ファイルを細分化し, 個々をダウンロードしつつ, 再生した分は削除する形式. データが残らないため, 著作権の問題もクリアしやすい.

### メディアタイプ
- レスポンシブデザインのために, 様々な機器を**メディアタイプ**を通して HTML, CSS で指定できる.